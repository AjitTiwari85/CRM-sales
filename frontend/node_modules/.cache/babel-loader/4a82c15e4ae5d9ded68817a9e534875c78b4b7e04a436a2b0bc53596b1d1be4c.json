{"ast":null,"code":"import React,{useEffect,useState,useCallback}from\"react\";import axiosInstance from\"../api/axiosInstance\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DealTable=()=>{const[deals,setDeals]=useState([]);const[search,setSearch]=useState(\"\");const[stage,setStage]=useState(\"\");const fetchDeals=useCallback(async()=>{try{const params={};if(search)params.search=search;if(stage)params.stage=stage;const res=await axiosInstance.get(\"/deals\",{params});setDeals(res.data);}catch(err){console.error(\"Error fetching deals:\",err);}},[search,stage]);// ✅ dependencies go here\nuseEffect(()=>{fetchDeals();},[fetchDeals]);// ✅ now safe and clean\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Deals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-bar\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Search deals...\",value:search,onChange:e=>setSearch(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{value:stage,onChange:e=>setStage(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"New\",children:\"New\"}),/*#__PURE__*/_jsx(\"option\",{value:\"In Progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Won\",children:\"Won\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Lost\",children:\"Lost\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchDeals,children:\"Filter\"})]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Stage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:deals.length>0?deals.map(d=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:d.title}),/*#__PURE__*/_jsx(\"td\",{children:d.amount}),/*#__PURE__*/_jsx(\"td\",{children:d.stage})]},d._id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",children:\"No deals found\"})})})]})]});};export default DealTable;","map":{"version":3,"names":["React","useEffect","useState","useCallback","axiosInstance","jsx","_jsx","jsxs","_jsxs","DealTable","deals","setDeals","search","setSearch","stage","setStage","fetchDeals","params","res","get","data","err","console","error","className","children","placeholder","value","onChange","e","target","onClick","length","map","d","title","amount","_id","colSpan"],"sources":["C:/Users/rt541/OneDrive/Desktop/CRM for sales/frontend/src/components/DealTable.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport axiosInstance from \"../api/axiosInstance\";\r\n\r\nconst DealTable = () => {\r\n  const [deals, setDeals] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [stage, setStage] = useState(\"\");\r\n\r\n  const fetchDeals = useCallback(async () => {\r\n    try {\r\n      const params = {};\r\n      if (search) params.search = search;\r\n      if (stage) params.stage = stage;\r\n\r\n      const res = await axiosInstance.get(\"/deals\", { params });\r\n      setDeals(res.data);\r\n    } catch (err) {\r\n      console.error(\"Error fetching deals:\", err);\r\n    }\r\n  }, [search, stage]); // ✅ dependencies go here\r\n\r\n  useEffect(() => {\r\n    fetchDeals();\r\n  }, [fetchDeals]); // ✅ now safe and clean\r\n\r\n  return (\r\n    <div className=\"card\">\r\n      <h2>Deals</h2>\r\n      <div className=\"filter-bar\">\r\n        <input \r\n          placeholder=\"Search deals...\" \r\n          value={search} \r\n          onChange={(e) => setSearch(e.target.value)} \r\n        />\r\n        <select value={stage} onChange={(e) => setStage(e.target.value)}>\r\n          <option value=\"\">All</option>\r\n          <option value=\"New\">New</option>\r\n          <option value=\"In Progress\">In Progress</option>\r\n          <option value=\"Won\">Won</option>\r\n          <option value=\"Lost\">Lost</option>\r\n        </select>\r\n        <button onClick={fetchDeals}>Filter</button>\r\n      </div>\r\n\r\n      <table>\r\n        <thead>\r\n          <tr><th>Title</th><th>Amount</th><th>Stage</th></tr>\r\n        </thead>\r\n        <tbody>\r\n          {deals.length > 0 ? (\r\n            deals.map((d) => (\r\n              <tr key={d._id}>\r\n                <td>{d.title}</td>\r\n                <td>{d.amount}</td>\r\n                <td>{d.stage}</td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr><td colSpan=\"3\">No deals found</td></tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DealTable;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}